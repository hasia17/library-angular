import { Component, EventEmitter, Inject, Input, Output } from '@angular/core';
import { IconsService } from '../../../api/services/icons.service';
import { FormBuilder, Validators } from '@angular/forms';
import { LaunchpadService } from '../../../api/services/launchpad.service';
import { AUTH_SERVICE } from '../../../api/injection-tokens';
import { MessageService } from 'primeng/api';
import { ConfigurationService } from '../../../api/configuration.service';
export class AddToLaunchpadComponent {
    constructor(iconsService, fb, launchpadService, auth, messageService, confService) {
        this.iconsService = iconsService;
        this.fb = fb;
        this.launchpadService = launchpadService;
        this.auth = auth;
        this.messageService = messageService;
        this.confService = confService;
        this.closed = new EventEmitter();
        this.launchpads = [];
    }
    ngOnInit() {
        this.iconsService.getPrimeicons().subscribe(icons => (this.icons = icons.filter(i => !!i)), error => console.log(error));
        this.launchpadForm = this.fb.group({
            icon: ['', Validators.required],
            type: [{ value: 'FAVOURITE', disabled: true }],
            name: ['', Validators.required],
            appId: [{ value: this.appId, disabled: true }],
            appUrl: [
                {
                    value: window.location.href.replace(window.location.origin, ''),
                    disabled: true,
                },
            ],
            launchpad: ['', Validators.required],
        });
        const launchpadCriteria = {
            portalId: this.confService.getProperty('TKIT_PORTAL_ID'),
        };
        this.launchpadService.getLaunchpads(launchpadCriteria).subscribe(data => (this.launchpads = data), error => console.log(error));
    }
    addToLaunchpad() {
        const createTileDTO = {
            appId: this.launchpadForm.get('appId').value,
            appUrl: this.launchpadForm.get('appUrl').value,
            name: this.launchpadForm.get('name').value,
            type: this.launchpadForm.get('type').value,
            icon: this.launchpadForm.get('icon').value,
        };
        this.launchpadService.addToLaunchpad(this.launchpadForm.get('launchpad').value.id, createTileDTO).subscribe(() => {
            this.messageService.add({
                summary: 'App added to favourites successfully',
                severity: 'success',
            });
            this.close();
        }, () => {
            this.messageService.add({
                summary: 'Failed to add app to favourites',
                severity: 'error',
            });
        });
    }
    filterIcons(event) {
        const query = event.query.toLowerCase();
        this.filteredIcons = this.icons.filter(icon => icon.toLowerCase().includes(query));
    }
    close(event) {
        this.closed.emit(false);
    }
}
AddToLaunchpadComponent.decorators = [
    { type: Component, args: [{
                selector: 'tk-add-to-launchpad',
                template: "<p-dialog\n  header=\"Add to Favourites\"\n  [contentStyle]=\"{ overflow: 'visible' }\"\n  [style]=\"{ width: '700px', 'max-height': '600px' }\"\n  [(visible)]=\"display\"\n  (onHide)=\"close($event)\"\n  [modal]=\"true\"\n>\n  <form [formGroup]=\"launchpadForm\" (ngSubmit)=\"addToLaunchpad()\">\n    <div class=\"p-fluid modal-content\">\n      <div class=\"p-field p-grid\">\n        <label for=\"name\" class=\"p-col-12 p-md-3\">Tile Name: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <input formControlName=\"name\" id=\"name\" type=\"text\" pInputText />\n        </div>\n      </div>\n      <div class=\"p-field p-grid\">\n        <label for=\"appId\" class=\"p-col-12 p-md-3\">AppId: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <input formControlName=\"appId\" id=\"appId\" type=\"text\" pInputText />\n        </div>\n      </div>\n      <div class=\"p-field p-grid\">\n        <label for=\"appUrl\" class=\"p-col-12 p-md-3\">AppUrl: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <input formControlName=\"appUrl\" id=\"appUrl\" type=\"text\" pInputText />\n        </div>\n      </div>\n      <div class=\"p-field p-grid\">\n        <label for=\"launchpad\" class=\"p-col-12 p-md-3\">Launchpad: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <p-dropdown\n            inputId=\"launchpad\"\n            [options]=\"launchpads\"\n            formControlName=\"launchpad\"\n            placeholder=\"{{ 'LAUNCHPAD.SELECT_LAUNCHPAD' | translate }}\"\n          >\n            <ng-template let-item pTemplate=\"item\">\n              <span class=\"custom-launchpad-container\">\n                <span> {{ item.name }} </span>\n                <span>\n                  {{ item.type }}\n                </span>\n              </span>\n            </ng-template>\n          </p-dropdown>\n        </div>\n      </div>\n      <div class=\"p-field p-grid\">\n        <label for=\"type\" class=\"p-col-12 p-md-3\">{{ \"LAUNCHPAD.TILE_TYPE\" | translate }}: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <input id=\"text\" type=\"text\" pInputText formControlName=\"type\" value=\"FAVOURITE\" readonly />\n        </div>\n      </div>\n      <div class=\"p-field p-grid\">\n        <label for=\"icon\" class=\"p-col-12 p-md-3\">Icon: </label>\n        <div class=\"p-col-12 p-md-9\">\n          <p-autoComplete\n            [suggestions]=\"filteredIcons\"\n            inputId=\"icon\"\n            formControlName=\"icon\"\n            (completeMethod)=\"filterIcons($event)\"\n            placeholder=\"{{ 'LAUNCHPAD.SELECT_ICON' | translate }}\"\n            forceSelection=\"true\"\n            completeOnFocus=\"true\"\n          >\n            <ng-template let-icon pTemplate=\"item\">\n              <div class=\"custom-item-container\">\n                <div>{{ icon }}</div>\n                <span class=\"pi pi-{{icon}}\"></span>\n              </div>\n            </ng-template>\n          </p-autoComplete>\n        </div>\n      </div>\n    </div>\n    <p-footer class=\"submit\">\n      <button\n        pButton\n        type=\"submit\"\n        label=\"{{ 'LAUNCHPAD.SAVE' | translate }}\"\n        [disabled]=\"!launchpadForm.valid\"\n      ></button>\n    </p-footer>\n  </form>\n</p-dialog>\n",
                styles: [".custom-launchpad-container{display:flex}.custom-launchpad-container span:last-of-type{margin-left:auto}.submit{padding:.5em 0;margin-top:20px}.submit button{margin-top:.5em;width:100%}.custom-item-container div{display:inline-block}.custom-item-container span{float:left;margin-right:5px}"]
            },] }
];
AddToLaunchpadComponent.ctorParameters = () => [
    { type: IconsService },
    { type: FormBuilder },
    { type: LaunchpadService },
    { type: undefined, decorators: [{ type: Inject, args: [AUTH_SERVICE,] }] },
    { type: MessageService },
    { type: ConfigurationService }
];
AddToLaunchpadComponent.propDecorators = {
    display: [{ type: Input }],
    appId: [{ type: Input }],
    closed: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkLXRvLWxhdW5jaHBhZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9wb3J0YWwtbGliL3NyYy9saWIvdGtpdC1wb3J0YWwvY29tcG9uZW50cy9hZGQtdG8tbGF1bmNocGFkL2FkZC10by1sYXVuY2hwYWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFBO0FBQ3RGLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQTtBQUNsRSxPQUFPLEVBQUUsV0FBVyxFQUFhLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFBO0FBQ25FLE9BQU8sRUFBeUMsZ0JBQWdCLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQTtBQUNqSCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0JBQStCLENBQUE7QUFLNUQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUM1QyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQTtBQU96RSxNQUFNLE9BQU8sdUJBQXVCO0lBYWxDLFlBQ1UsWUFBMEIsRUFDMUIsRUFBZSxFQUNmLGdCQUFrQyxFQUNILElBQWtCLEVBQ3hDLGNBQThCLEVBQzlCLFdBQWlDO1FBTDFDLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBQzFCLE9BQUUsR0FBRixFQUFFLENBQWE7UUFDZixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ0gsU0FBSSxHQUFKLElBQUksQ0FBYztRQUN4QyxtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsZ0JBQVcsR0FBWCxXQUFXLENBQXNCO1FBYjdDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBVyxDQUFBO1FBRXBDLGVBQVUsR0FBbUIsRUFBRSxDQUFB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RUFBRSxPQUFPO2FBQ2xCLENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FDRixDQUFBO0lBQ0gsQ0FBQztJQUVNLFdBQVcsQ0FBQyxLQUFLO1FBQ3RCLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUE7UUFDdkMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtJQUNwRixDQUFDO0lBRU0sS0FBSyxDQUFDLEtBQVc7UUFDdEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDekIsQ0FBQzs7O1lBdkZGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUscUJBQXFCO2dCQUMvQixpdUdBQWdEOzthQUVqRDs7O1lBZlEsWUFBWTtZQUNaLFdBQVc7WUFDNEIsZ0JBQWdCOzRDQStCM0QsTUFBTSxTQUFDLFlBQVk7WUF6QmYsY0FBYztZQUNkLG9CQUFvQjs7O3NCQVExQixLQUFLO29CQUVMLEtBQUs7cUJBRUwsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbmplY3QsIElucHV0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnXG5pbXBvcnQgeyBJY29uc1NlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9hcGkvc2VydmljZXMvaWNvbnMuc2VydmljZSdcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtR3JvdXAsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3JtcydcbmltcG9ydCB7IEdldEFsbExhdW5jaHBhZHNGaWx0ZXJlZFJlcXVlc3RQYXJhbXMsIExhdW5jaHBhZFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9hcGkvc2VydmljZXMvbGF1bmNocGFkLnNlcnZpY2UnXG5pbXBvcnQgeyBBVVRIX1NFUlZJQ0UgfSBmcm9tICcuLi8uLi8uLi9hcGkvaW5qZWN0aW9uLXRva2VucydcbmltcG9ydCB7IElBdXRoU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL2FwaS9pYXV0aC5zZXJ2aWNlJ1xuaW1wb3J0IHsgTGF1bmNocGFkRFRPIH0gZnJvbSAnLi4vLi4vLi4vYXBpL21vZGVsL2xhdW5jaHBhZERUTydcbmltcG9ydCB7IExhdW5jaHBhZFRpbGVDcmVhdGVEVE8gfSBmcm9tICcuLi8uLi8uLi9hcGkvbW9kZWwvbGF1bmNocGFkVGlsZUNyZWF0ZURUTydcbmltcG9ydCB7IFRpbGVUeXBlIH0gZnJvbSAnLi4vLi4vLi4vYXBpL21vZGVsL3RpbGVUeXBlJ1xuaW1wb3J0IHsgTWVzc2FnZVNlcnZpY2UgfSBmcm9tICdwcmltZW5nL2FwaSdcbmltcG9ydCB7IENvbmZpZ3VyYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vYXBpL2NvbmZpZ3VyYXRpb24uc2VydmljZSdcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGstYWRkLXRvLWxhdW5jaHBhZCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9hZGQtdG8tbGF1bmNocGFkLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vYWRkLXRvLWxhdW5jaHBhZC5jb21wb25lbnQuc2NzcyddLFxufSlcbmV4cG9ydCBjbGFzcyBBZGRUb0xhdW5jaHBhZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBkaXNwbGF5OiBib29sZWFuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBhcHBJZDogc3RyaW5nXG4gIEBPdXRwdXQoKVxuICBwdWJsaWMgY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpXG5cbiAgcHVibGljIGxhdW5jaHBhZHM6IExhdW5jaHBhZERUT1tdID0gW11cbiAgcHVibGljIGljb25zOiBzdHJpbmdbXVxuICBwdWJsaWMgZmlsdGVyZWRJY29uczogc3RyaW5nW11cbiAgcHVibGljIGxhdW5jaHBhZEZvcm06IEZvcm1Hcm91cFxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgaWNvbnNTZXJ2aWNlOiBJY29uc1NlcnZpY2UsXG4gICAgcHJpdmF0ZSBmYjogRm9ybUJ1aWxkZXIsXG4gICAgcHJpdmF0ZSBsYXVuY2hwYWRTZXJ2aWNlOiBMYXVuY2hwYWRTZXJ2aWNlLFxuICAgIEBJbmplY3QoQVVUSF9TRVJWSUNFKSBwcml2YXRlIHJlYWRvbmx5IGF1dGg6IElBdXRoU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1lc3NhZ2VTZXJ2aWNlOiBNZXNzYWdlU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGNvbmZTZXJ2aWNlOiBDb25maWd1cmF0aW9uU2VydmljZVxuICApIHt9XG5cbiAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuaWNvbnNTZXJ2aWNlLmdldFByaW1laWNvbnMoKS5zdWJzY3JpYmUoXG4gICAgICBpY29ucyA9PiAodGhpcy5pY29ucyA9IGljb25zLmZpbHRlcihpID0+ICEhaSkpLFxuICAgICAgZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpXG4gICAgKVxuICAgIHRoaXMubGF1bmNocGFkRm9ybSA9IHRoaXMuZmIuZ3JvdXAoe1xuICAgICAgaWNvbjogWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICAgIHR5cGU6IFt7IHZhbHVlOiAnRkFWT1VSSVRFJywgZGlzYWJsZWQ6IHRydWUgfV0sXG4gICAgICBuYW1lOiBbJycsIFZhbGlkYXRvcnMucmVxdWlyZWRdLFxuICAgICAgYXBwSWQ6IFt7IHZhbHVlOiB0aGlzLmFwcElkLCBkaXNhYmxlZDogdHJ1ZSB9XSxcbiAgICAgIGFwcFVybDogW1xuICAgICAgICB7XG4gICAgICAgICAgdmFsdWU6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2Uod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgJycpLFxuICAgICAgICAgIGRpc2FibGVkOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIGxhdW5jaHBhZDogWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICB9KVxuXG4gICAgY29uc3QgbGF1bmNocGFkQ3JpdGVyaWE6IEdldEFsbExhdW5jaHBhZHNGaWx0ZXJlZFJlcXVlc3RQYXJhbXMgPSB7XG4gICAgICBwb3J0YWxJZDogdGhpcy5jb25mU2VydmljZS5nZXRQcm9wZXJ0eSgnVEtJVF9QT1JUQUxfSUQnKSxcbiAgICB9XG4gICAgdGhpcy5sYXVuY2hwYWRTZXJ2aWNlLmdldExhdW5jaHBhZHMobGF1bmNocGFkQ3JpdGVyaWEpLnN1YnNjcmliZShcbiAgICAgIGRhdGEgPT4gKHRoaXMubGF1bmNocGFkcyA9IGRhdGEpLFxuICAgICAgZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpXG4gICAgKVxuICB9XG5cbiAgcHVibGljIGFkZFRvTGF1bmNocGFkKCk6IHZvaWQge1xuICAgIGNvbnN0IGNyZWF0ZVRpbGVEVE86IExhdW5jaHBhZFRpbGVDcmVhdGVEVE8gPSB7XG4gICAgICBhcHBJZDogdGhpcy5sYXVuY2hwYWRGb3JtLmdldCgnYXBwSWQnKS52YWx1ZSBhcyBzdHJpbmcsXG4gICAgICBhcHBVcmw6IHRoaXMubGF1bmNocGFkRm9ybS5nZXQoJ2FwcFVybCcpLnZhbHVlIGFzIHN0cmluZyxcbiAgICAgIG5hbWU6IHRoaXMubGF1bmNocGFkRm9ybS5nZXQoJ25hbWUnKS52YWx1ZSBhcyBzdHJpbmcsXG4gICAgICB0eXBlOiB0aGlzLmxhdW5jaHBhZEZvcm0uZ2V0KCd0eXBlJykudmFsdWUgYXMgVGlsZVR5cGUsXG4gICAgICBpY29uOiB0aGlzLmxhdW5jaHBhZEZvcm0uZ2V0KCdpY29uJykudmFsdWUgYXMgc3RyaW5nLFxuICAgIH1cbiAgICB0aGlzLmxhdW5jaHBhZFNlcnZpY2UuYWRkVG9MYXVuY2hwYWQodGhpcy5sYXVuY2hwYWRGb3JtLmdldCgnbGF1bmNocGFkJykudmFsdWUuaWQsIGNyZWF0ZVRpbGVEVE8pLnN1YnNjcmliZShcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2VydmljZS5hZGQoe1xuICAgICAgICAgIHN1bW1hcnk6ICdBcHAgYWRkZWQgdG8gZmF2b3VyaXRlcyBzdWNjZXNzZnVsbHknLFxuICAgICAgICAgIHNldmVyaXR5OiAnc3VjY2VzcycsXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgfSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2VydmljZS5hZGQoe1xuICAgICAgICAgIHN1bW1hcnk6ICdGYWlsZWQgdG8gYWRkIGFwcCB0byBmYXZvdXJpdGVzJyxcbiAgICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICApXG4gIH1cblxuICBwdWJsaWMgZmlsdGVySWNvbnMoZXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBxdWVyeSA9IGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKClcbiAgICB0aGlzLmZpbHRlcmVkSWNvbnMgPSB0aGlzLmljb25zLmZpbHRlcihpY29uID0+IGljb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkpXG4gIH1cblxuICBwdWJsaWMgY2xvc2UoZXZlbnQ/OiBhbnkpIHtcbiAgICB0aGlzLmNsb3NlZC5lbWl0KGZhbHNlKVxuICB9XG59XG4iXX0=